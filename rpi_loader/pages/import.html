<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>Page Title</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="">
<style>
</style>
<script src=""></script>
<body>


<div class="">
 <h1>Import Election Data</h1>
 <p>Import data.json from one of the following usb devices</p>
<div id ="usbs"></div>
<button onclick="importData()">Import from Usb</button>
    
</div>
<script>
    const importData = () => {
        const checkedRadio = document.querySelector('input[name="usb"]:checked');
        if(!checkedRadio) return;

         const path = checkedRadio.value;
            
        
        const url = new URL("http://localhost:8080/dataImport");
        const params = {pathName: path};
        
        url.search = new URLSearchParams(params).toString();
        fetch(url).then(response => response.json())
                .then((body) => {
                        console.log(body);
                     
                        
                }); 
    }
    const showUsbs = () => {
        let usbsDiv = document.getElementById("usbs");
        usbsDiv.innerHTML = "";
        fetch('./usbs/').then(response => response.json())
                .then((body) => {
                        console.log(body);
                        data = JSON.parse(body);
                        console.log(data.usbs);
                        for(const usb of data.usbs){
                            if(usb.path == "/" || usb.path == "/boot/efi") continue; // HACK should not show these
                            let div = document.createElement("div");
                            let input = document.createElement("input");
                            let label = document.createElement("label");
                            input.setAttribute("type", "radio");
                            input.setAttribute("id", usb.path);
                            input.setAttribute("name", "usb");
                            input.setAttribute("value", usb.path);
                            input.setAttribute("class", "radio");
                            input.checked = false;
                            label.innerText = usb.path;
                            div.appendChild(input);
                            div.appendChild(label);
                            usbsDiv.appendChild(div);
                        }
                }); 
                
    }
    showUsbs();
</script>
</body>
</html> 